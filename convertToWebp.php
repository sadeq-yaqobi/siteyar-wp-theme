<?php
 function convertToWebP(string $sourceDir, string $outputDir, int $quality = 80, string $options = '') { if (!is_dir($outputDir)) { mkdir($outputDir, 0777, true); } $images = glob("$sourceDir/*.{jpg,jpeg,png}", GLOB_BRACE); foreach ($images as $image) { $imageInfo = pathinfo($image); $outputFile = $outputDir . '/' . $imageInfo['filename'] . '.webp'; $command = "cwebp -q $quality $options {$imageInfo['dirname']}/{$imageInfo['basename']} -o $outputFile"; exec($command, $output, $return_var); if ($return_var !== 0) { echo "Error converting {$imageInfo['basename']} to WebP\n"; } else { echo "{$imageInfo['basename']} converted successfully to WebP\n"; } } } convertToWebP('assets/img', 'assets/img/webp');