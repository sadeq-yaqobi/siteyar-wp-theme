<?php
 add_action('wp_ajax_hottest', 'hottest'); add_action('wp_ajax_nopriv_hottest', 'hottest'); function hottest() { if (!wp_verify_nonce($_POST['_nonce'])) { wp_send_json([ 'error' => true, 'message' => 'access denied' ], 403); } $args = [ 'post_type' => ['tech'], 'showposts' => 3, 'orderby' => 'comment_count', 'order' => 'DESC', ]; $the_query = new WP_Query($args); if ($the_query->have_posts()): $html_output = ''; while ($the_query->have_posts()):$the_query->the_post(); $html_output .= sy_tech_html_output(); endwhile; wp_send_json([ 'success' => true, 'message' => 'فیلتر محتوا بر اساس داغ‌ترین پست‌ها با موفقیت اعمال گردید', 'content' => $html_output ], 200); else: wp_send_json([ 'error' => true, 'message' => 'داغ‌ترین پستی یافت نشد', ],403); endif; wp_reset_postdata(); }